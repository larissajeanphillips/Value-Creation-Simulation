###############################################################################
# ---------------------- DO NOT EDIT THIS FILE !!!-----------------------------
#
# This file is generated by Deployer K8s PaaS ControlPlane.
# Any changes to this file can be overwritten at any time by the ControlPlane.
#
###############################################################################
name: citizen-dev7-dev-us-Deploy secrets

on:
  workflow_dispatch:

jobs:
  load-environment-vars:
    name: environment-context
    runs-on: [gh-larger-linux-mini]
    environment: "citizen-dev7-dev-us-east-1"
    outputs:
      TFE_ORG: ${{ vars.TF_ORG }}
      TF_WORKSPACE: ${{ vars.TF_WORKSPACE }}
      CLUSTER_LOGIN_URL: ${{ vars.KUBERNETES_CLUSTER_LOGIN_URL }}
      KUBERNETES_NAMESPACE_NAME: ${{ vars.KUBERNETES_NAMESPACE_NAME }}

    steps:
      - name: Run
        id: setup-env
        run: |
          echo "Setup environment specific variables and secrets"
          echo "TF_ORG: ${{ vars.TF_ORG }}"
          echo "TF_WORKSPACE: ${{ vars.TF_WORKSPACE }}"
          echo "CLUSTER_LOGIN_URL: ${{ vars.KUBERNETES_CLUSTER_LOGIN_URL}}"
          echo "KUBERNETES_NAMESPACE_NAME: ${{ vars.KUBERNETES_NAMESPACE_NAME }}"

  deploy-user-secrets:
    name: User's secrets
    needs: [load-environment-vars]
    uses: McK-Internal/lrah-control-plane/.github/workflows/lrah-reusable-deploy-user-secrets.yaml@v1.21.0
    with:
      environment: "citizen-dev7-dev-us-east-1"
      cluster_login_url: ${{ needs.load-environment-vars.outputs.CLUSTER_LOGIN_URL }}
      kubernetes_namespace_name: ${{ needs.load-environment-vars.outputs.KUBERNETES_NAMESPACE_NAME }}
    secrets: inherit
