---
description: Docker setup wizard for Agent Workspace starter template
alwaysApply: false
---

# Docker Setup Guide for Agent Workspace

When a user requests Docker setup (via `/docker-setup` command, `/setup` command in Agent Workspace context, or says "set up docker", "configure docker", "help me start the app"), follow this guide.

## Auto-Detection

The `/setup` command should automatically detect if you're in an Agent Workspace and use this guide instead of the standard project setup.

## Step 1: Check Docker Availability

**Immediately check Docker status:**

```bash
# Check if Docker is installed
docker --version 2>&1 || echo "Docker not installed"

# Check if Docker daemon is running
docker ps > /dev/null 2>&1 && echo "Docker is running" || echo "Docker not running"
```

**Handle results:**

- **Docker not installed:**
  - Inform user: "Docker Desktop is not installed. You'll need it to run this application."
  - Provide download link: https://www.docker.com/products/docker-desktop/
  - Explain: "Once installed, run this command again to continue setup."

- **Docker not running:**
  - Inform user: "Docker Desktop is installed but not running."
  - Instructions: "Please start Docker Desktop (look for the whale icon in your system tray/menu bar), wait for it to fully start, then run this command again."

- **Docker running:**
  - Proceed to Step 2

## Step 2: Check Current Configuration

**Check if .env file exists:**

```bash
cd deployer-apps/*/src 2>/dev/null || cd .
if [ -f ".env" ]; then
  echo "‚úÖ .env file exists"
  # Check if it has placeholder values
  if grep -q "your_instance_id_here\|your_client_id" .env 2>/dev/null; then
    echo "‚ö†Ô∏è  .env contains placeholder values - needs configuration"
  else
    echo "‚úÖ .env appears configured"
  fi
else
  echo "‚ùå .env file not found"
fi
```

## Step 3: Collect AI Gateway Credentials

**Use AskQuestion tool to collect credentials interactively:**

```json
{
  "title": "Docker Setup - AI Gateway Configuration",
  "questions": [
    {
      "id": "credentials_status",
      "prompt": "Do you have your AI Gateway credentials?\n\nYou need:\n‚Ä¢ Instance ID (from Platform McKinsey)\n‚Ä¢ API Key (format: clientID:clientSecret)\n\nGet them from: Platform McKinsey > AI Gateway service\n\nNote: If you're building a generic webapp (not using agents), you can skip this.",
      "options": [
        { "id": "have_them", "label": "Yes, I have them ready" },
        { "id": "need_help", "label": "I need help getting them" },
        { "id": "skip", "label": "Skip for now - I'll configure later" }
      ]
    }
  ]
}
```

**Process responses:**

- **"have_them"**: Ask for credentials in chat, then create .env file
- **"need_help"**: Provide detailed instructions, then ask again
- **"skip"**: Create .env from .env.example, inform user they need to edit it

## Step 4: Create .env File

**If credentials provided:**

Ask user for values in chat:
- "Please provide your AI Gateway Instance ID:"
- "Please provide your AI Gateway API Key (format: clientID:clientSecret):"

Then create the file:
```bash
cd deployer-apps/*/src 2>/dev/null || cd .
cat > .env << 'EOF'
AI_GATEWAY_INSTANCE_ID=<user_provided_instance_id>
AI_GATEWAY_API_KEY=<user_provided_api_key>
EOF
```

**If skipped:**

```bash
cd deployer-apps/*/src 2>/dev/null || cd .
if [ -f ".env.example" ]; then
  cp .env.example .env
  echo "Created .env from template. Please edit it with your credentials."
else
  cat > .env << 'EOF'
AI_GATEWAY_INSTANCE_ID=your_instance_id_here
AI_GATEWAY_API_KEY=your_client_id:your_client_secret
EOF
  echo "Created .env file. Please edit it with your credentials."
fi
```

## Step 5: Verify Script Permissions

**Ensure docker-dev.sh is executable:**

```bash
cd deployer-apps/*/src 2>/dev/null || cd .
if [ -f "scripts/docker-dev.sh" ]; then
  chmod +x scripts/docker-dev.sh
  echo "‚úÖ Script is executable"
else
  echo "‚ùå docker-dev.sh not found"
fi
```

## Step 6: Offer to Start Application

**Ask if user wants to start now:**

```json
{
  "title": "Ready to Start?",
  "questions": [
    {
      "id": "start_app",
      "prompt": "Would you like to start the application now?\n\nThis will:\n‚Ä¢ Build Docker image (first time: ~2-3 minutes)\n‚Ä¢ Start container with hot reloading\n‚Ä¢ Make app available at http://localhost:3000\n\nYou can also start it later with: ./scripts/docker-dev.sh",
      "options": [
        { "id": "yes", "label": "Yes, start it now" },
        { "id": "no", "label": "No, I'll start it later" }
      ]
    }
  ]
}
```

**If "yes" - ACTUALLY LAUNCH DOCKER:**

**CRITICAL: Run the command directly, don't just provide instructions!**

```bash
# Navigate to src directory
cd deployer-apps/*/src 2>/dev/null || cd .

# Make script executable (if needed, especially on Windows)
chmod +x scripts/docker-dev.sh 2>/dev/null || true

# Launch Docker - this runs in foreground so user sees output
./scripts/docker-dev.sh
```

**Important:** 
- **Actually execute** `./scripts/docker-dev.sh` - don't just tell user to run it
- User will see Docker build/output in real-time
- User can press Ctrl+C to stop when needed
- First build takes 2-3 minutes, then app is available at http://localhost:3000
- On Windows, use `bash scripts/docker-dev.sh` if PowerShell has issues

**After launching, inform user:**
```
üöÄ Docker is starting your application...

The first build will take 2-3 minutes. You'll see the build progress above.

Once complete, your app will be available at:
  http://localhost:3000

üí° Tips:
   ‚Ä¢ Backend changes (Python files) hot reload automatically
   ‚Ä¢ UI changes require rebuild (use --build flag)
   ‚Ä¢ Press Ctrl+C to stop the container

Windows users: No elevated permissions needed! Everything runs in Docker.
```

**If "no":**

```
‚úÖ Setup complete! When you're ready to start:

  cd deployer-apps/<instance-name>/src
  ./scripts/docker-dev.sh

The app will be available at http://localhost:3000
```

## Step 7: Provide Summary

**Always provide a clear summary:**

```
‚úÖ Docker Setup Complete!

üìÅ Configuration:
   ‚Ä¢ .env file: deployer-apps/<instance-name>/src/.env
   ‚Ä¢ Docker script: scripts/docker-dev.sh (executable)

üöÄ To start the application:
   cd deployer-apps/<instance-name>/src
   ./scripts/docker-dev.sh

üåê App URL: http://localhost:3000

üìö Helpful resources:
   ‚Ä¢ QUICKSTART.md - Detailed Docker instructions
   ‚Ä¢ START_HERE.md - 2-minute quick start guide
   ‚Ä¢ WINDOWS_SETUP.md - Windows-specific guide (no permission issues!)
   ‚Ä¢ README.md - Full documentation

üí° Tips:
   ‚Ä¢ First build takes 2-3 minutes
   ‚Ä¢ Backend changes hot reload automatically
   ‚Ä¢ UI changes require rebuild (use --build flag)
   ‚Ä¢ Windows: No Node.js/Python/esbuild needed - Docker handles everything!
```

## Error Handling

**Docker not installed:**
- Provide clear download instructions
- Explain why Docker is needed
- Offer to help again after installation

**Docker not running:**
- Clear instructions to start Docker Desktop
- How to verify it's running
- Offer to check again

**Missing credentials:**
- Don't block setup - allow skip
- Clear instructions on where to get them
- Remind user they need them before running (if using agent framework)

**Port 3000 in use:**
- Help identify what's using the port
- Suggest alternative port modification
- Provide instructions to modify docker-dev.sh

**Script not found:**
- Verify we're in the right directory
- Check if this is the correct template
- Provide navigation instructions

**Windows execution policy:**
- Suggest using Git Bash: `bash scripts/docker-dev.sh`
- Or change PowerShell policy (one-time)
- Or use Command Prompt

## Critical Instructions

1. **Check Docker FIRST** - Don't proceed without Docker
2. **Create .env automatically** - Don't ask user to manually create
3. **ACTUALLY LAUNCH DOCKER when user says "yes"** - Run `./scripts/docker-dev.sh` directly (not in background)
4. **Let user see output** - Docker build/output should be visible to user
5. **User controls stopping** - They can press Ctrl+C when done
6. **Provide clear feedback** - Explain what's happening at each step
7. **Handle errors gracefully** - Guide to solutions, don't just fail
8. **Windows users** - Emphasize no permission issues, no local tools needed

## Integration with Setup Workflow

This Docker setup is integrated into the main setup workflow:

- `/setup` command auto-detects Agent Workspace and uses this guide
- `/docker-setup` command directly launches this workflow
- After setup, Docker is automatically launched if user chooses "yes"
- Makes Docker the default/recommended way to run
