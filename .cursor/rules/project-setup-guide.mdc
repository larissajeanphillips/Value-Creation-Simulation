---
description: Conversational setup wizard for configuring web apps
alwaysApply: false
---

# Project Setup Guide

This rule defines how to run the `/setup` wizard - a conversational, step-by-step process that gathers context about what the user is building, creates an implementation plan for approval, and then customizes the project accordingly.

## CRITICAL: Plan-First Requirement

**After gathering all user inputs, you MUST:**

1. **Create a Cursor plan file** - Write to `~/.cursor/plans/[app_name]_[hex].plan.md`
2. **Use proper format** - YAML frontmatter with `name`, `overview`, `todos`, `isProject: false`
3. **Include architecture** - Mermaid diagram showing app structure
4. **Wait for user confirmation** - User clicks "Build this" or confirms in chat
5. **Only then build** - Implement following the plan's todo list

**DO NOT skip the planning step. DO NOT write code until user confirms.**

## Trigger

Activate when user says:
- `/setup`
- "Set up my app"
- "Configure my app"
- "I want to start building"
- "Help me create an app"

## Flow Overview

```
0. Existing App Check: Detect if there's already a webapp, offer to keep or replace
1. Approach: Quick Start or Plan First (PRD)
2. Context: What are you building for?
3. Description: Describe your app
4. Features: Multi-select feature types
5. Visual Inspiration: Images, design links, or description (optional)
6. Existing Code: GitHub repos, local code, or snippets (optional)
7. Existing Data: Data files, database, or examples (optional)
8. Name: What to call the app
9. Runtime: Docker or local
10. **PLAN: Create .plan.md file, user clicks "Build this"**
11. Build: Apply customizations (only after plan confirmed)
12. Start: Launch the app + auto-open browser
```

## Step-by-Step Implementation

### Step 0: Existing Webapp Detection

**Before starting the wizard, check if there's an existing webapp that differs from the starter template.**

#### Detection Logic

Check for signs of an existing custom webapp by examining the UI directory:

```
deployer-apps/citizen-dev7/src/ui/src/
```

**Indicators of a STARTER template (no existing app):**
- Only has Chat-related components: `ChatWindow.tsx`, `MessageBubble.tsx`, `InputBar.tsx`, `Sidebar.tsx`, `TypingIndicator.tsx`
- `App.tsx` primarily renders a chat interface
- No custom pages like `Dashboard.tsx`, `ProjectsPage.tsx`, `AnalyticsPage.tsx`, etc.
- No `data/` folder with custom types or sample data

**Indicators of an EXISTING custom webapp:**
- Has additional components beyond the chat UI (Dashboard, Forms, Tables, etc.)
- Has a `data/` folder with `types.ts`, `sampleData.ts`, or similar
- `App.tsx` has custom routing/navigation logic
- `package.json` has a custom name (not the default)

#### Detection Steps

1. **Read the components directory:**
   ```bash
   ls deployer-apps/citizen-dev7/src/ui/src/components/
   ```

2. **Check for data folder:**
   ```bash
   ls deployer-apps/citizen-dev7/src/ui/src/data/ 2>/dev/null
   ```

3. **Read package.json name:**
   ```bash
   grep '"name"' deployer-apps/citizen-dev7/src/ui/package.json
   ```

4. **Evaluate:**
   - If ONLY starter components exist (Chat*, Message*, Input*, Sidebar, TypingIndicator) → **No existing app, skip to Step 1**
   - If additional custom components exist → **Existing app detected, proceed with choice**

#### If Existing App Detected

Tell the user what was found, then use AskQuestion:

"**I found an existing webapp in this project!**

It looks like there's already a custom app built here with components like [list 3-4 key components found].

Before we continue, I need to know what you'd like to do with it:"

```json
{
  "title": "Existing Webapp Detected",
  "questions": [{
    "id": "existing_app",
    "prompt": "What would you like to do with the existing app?",
    "options": [
      { "id": "delete", "label": "Delete it - Start completely fresh with a new app" },
      { "id": "keep", "label": "Keep it - Create my new app in a separate folder" }
    ]
  }]
}
```

#### If "delete" selected

1. **Warn the user:**
   "⚠️ This will permanently delete the existing webapp code. The files will be removed and cannot be recovered unless you have a backup or committed them to git."

2. **Confirm with another question:**
   ```json
   {
     "title": "Confirm Deletion",
     "questions": [{
       "id": "confirm_delete",
       "prompt": "Are you sure you want to delete the existing webapp?",
       "options": [
         { "id": "yes", "label": "Yes, delete it and start fresh" },
         { "id": "no", "label": "No, keep it and create a new folder instead" }
       ]
     }]
   }
   ```

3. **If confirmed, delete custom files:**
   - Remove all components EXCEPT the starter template ones (ChatWindow, MessageBubble, InputBar, Sidebar, TypingIndicator)
   - Remove `data/` folder if it exists
   - Reset `App.tsx` to the starter template version
   - Reset `package.json` name to default
   - Reset `index.html` title to default

4. **Tell user:** "✓ Existing app removed. Starting fresh!"

5. **Continue to Step 1**

#### If "keep" selected

1. **Create a new app folder structure:**
   
   Create a new directory at:
   ```
   deployer-apps/citizen-dev7/src/apps/[new-app-name]/
   ```
   
   This will be a clone of the starter template with its own:
   - `ui/` folder with fresh React app
   - `api.py` for backend
   - All necessary config files

2. **Clone the starter template:**
   
   Copy the following files/folders to the new app directory:
   ```
   deployer-apps/citizen-dev7/src/
   ├── ui/                    # Clone the starter UI template
   │   ├── src/
   │   │   ├── components/    # Only starter components (Chat*, etc.)
   │   │   ├── App.tsx        # Starter version
   │   │   └── ...
   │   ├── package.json       # Fresh package.json
   │   ├── index.html         # Fresh index.html
   │   └── ...
   ├── api.py                 # Clone the API
   └── ...
   ```

3. **Ask for the new app name:**
   
   "What would you like to call your new app? This will be used for the folder name."

4. **Create the new app folder:**
   
   The new structure will be:
   ```
   deployer-apps/citizen-dev7/src/
   ├── ui/                           # Existing app (preserved)
   ├── apps/
   │   └── [new-app-name]/
   │       ├── ui/                   # New app UI
   │       │   ├── src/
   │       │   │   ├── components/
   │       │   │   ├── App.tsx
   │       │   │   └── ...
   │       │   ├── package.json
   │       │   ├── index.html
   │       │   └── ...
   │       └── api.py
   ```

5. **Update working context:**
   
   Tell the user and set context for the rest of the wizard:
   
   "✓ Created new app folder at `apps/[new-app-name]/`
   
   Your existing app is preserved in `ui/`. The setup wizard will now configure your new app."

6. **Continue to Step 1** with the new app folder as the target

### Step 1: Choose Your Approach

Use AskQuestion:

```json
{
  "title": "Let's set up your app!",
  "questions": [{
    "id": "approach",
    "prompt": "How would you like to get started?",
    "options": [
      { "id": "quick", "label": "Quick Start - I'm just playing around" },
      { "id": "prd", "label": "Detailed Plan - I'm building something real and need proper requirements" }
    ]
  }]
}
```

**If "prd" selected:**
- Read and follow the PRD generator skill at `.cursor/skills/prd-generator/SKILL.md`
- After PRD is complete, return here and continue from Step 2

**If "quick" selected:**
- Continue with Steps 2-9 below

### Step 2: Context

Use AskQuestion:

```json
{
  "title": "Let's Set Up Your App",
  "questions": [{
    "id": "purpose",
    "prompt": "What are you building this for?\n\nThis helps me adjust the style and polish level.",
    "options": [
      { "id": "client", "label": "A client project or engagement" },
      { "id": "internal", "label": "An internal tool for my team" },
      { "id": "personal", "label": "A personal project or learning" },
      { "id": "other", "label": "Something else" }
    ]
  }]
}
```

### Step 3: Description

**Show the inspiration examples directly in chat (no external tools needed):**

Present the app ideas visually in the chat itself - this works for everyone regardless of what's installed:

"**Here are some examples of apps you can build:**

| App Type | Description |
|----------|-------------|
| **Project Dashboard** | Track project status, milestones, and team progress with charts and metrics |
| **Client Portal** | Give clients a place to view deliverables, track progress, and communicate |
| **Feedback Collector** | Gather workshop feedback, survey responses, or customer reviews |
| **Data Explorer** | Filter, sort, and analyze data with an interactive table and export to Excel |
| **AI Assistant** | A chatbot that answers questions about your products, services, or documents |
| **Request Tracker** | Submit and track requests, approvals, or tickets with status updates |
| **Team Directory** | A searchable directory of team members with photos, roles, and contact info |
| **File Sharing** | Upload and share documents with your team or clients securely |

**Or describe your own idea!**

Describe your app in a sentence or two - what should it do? Who will use it?

Examples:
- 'A dashboard for clients to see project status and milestones'
- 'A tool for tracking workshop feedback and generating reports'
- 'A form where customers submit support requests'"

### Step 4: Features

Use AskQuestion with multi-select:

```json
{
  "title": "What features does your app need?",
  "questions": [{
    "id": "features",
    "prompt": "Select all that apply:",
    "allow_multiple": true,
    "options": [
      { "id": "dashboard", "label": "Dashboard & Charts - Display data with graphs, tables, and metrics" },
      { "id": "forms", "label": "Forms & Data Entry - Collect information with forms and validation" },
      { "id": "analytics", "label": "Data Analytics - Filter, sort, search, and export data" },
      { "id": "chatbot", "label": "AI Chatbot - Answer questions using AI (additional setup later)" },
      { "id": "files", "label": "File Upload/Download - Upload documents or download reports" },
      { "id": "auth", "label": "User Login - Require users to sign in" },
      { "id": "api", "label": "Connect to External Data - Pull data from APIs or databases" }
    ]
  }]
}
```

### Step 5: Visual & Design Inspiration

Use AskQuestion:

```json
{
  "title": "Visual & Design Inspiration (Optional)",
  "questions": [{
    "id": "visual",
    "prompt": "Do you have any visual inspiration?\n\nScreenshots, mockups, or reference images help me match your vision.",
    "options": [
      { "id": "images", "label": "Yes, I have images to share" },
      { "id": "links", "label": "Yes, I have website or design links" },
      { "id": "describe", "label": "I'll describe what I want" },
      { "id": "skip", "label": "No, use your best judgment" }
    ]
  }]
}
```

**If images:** 

"Share your inspiration images! You can:

**Paste or drag images directly into this chat:**
- Screenshots of apps you like
- UI mockups or wireframes
- Design inspiration from Dribbble, Behance, etc.
- Photos of sketches on paper

**Share multiple images** - I'll extract design patterns from all of them:
- Layout and structure
- Color palette and theming
- Typography and spacing
- Component styles (buttons, cards, forms)
- Navigation patterns

Just paste/drop as many images as you'd like!"

**If links:**

"Share links to websites or designs you'd like to draw inspiration from:

**Examples:**
- `https://dribbble.com/shots/...` - Dribbble designs
- `https://www.behance.net/gallery/...` - Behance projects
- `https://example-app.com` - Live websites you admire
- `https://ui8.net/...`, `https://figma.com/community/...` - UI kits

Just paste the URLs and I'll analyze them for:
- Visual style and aesthetics
- Layout patterns
- Component design
- Color schemes

You can share multiple links!"

**Processing inspiration:**
- **Images:** Analyze each image for colors, layout, typography, component styles
- **Links:** Fetch and analyze the page/design for visual patterns
- **Combine insights:** If multiple sources, identify common themes and create a unified style guide

**If describe:** "Describe the look you're going for. Examples: 'Clean like Notion', 'Professional with blue', 'Modern with shadows', 'Minimal like Linear', 'Colorful like Figma'"

### Step 6: Existing Code Reference

Use AskQuestion:

```json
{
  "title": "Build on Existing Code (Optional)",
  "questions": [{
    "id": "existing_code",
    "prompt": "Do you want to build on top of, or draw inspiration from, any existing code?",
    "options": [
      { "id": "github", "label": "Yes, I have a GitHub repo or link to share" },
      { "id": "local", "label": "Yes, I have code on my computer" },
      { "id": "paste", "label": "Yes, I'll paste some code snippets" },
      { "id": "none", "label": "No, starting fresh" }
    ]
  }]
}
```

**If github:**

"Paste your GitHub links! You can share:

**Repository links:**
- `https://github.com/org/repo` - Full repository
- `https://github.com/org/repo/tree/main/src` - Specific folder
- `https://github.com/org/repo/blob/main/src/App.tsx` - Specific file

**Multiple repos are fine!** I'll analyze patterns across all of them.

**What I'll look for:**
- Project structure and file organization
- Component architecture and patterns
- Styling approach (Tailwind, CSS Modules, styled-components)
- State management (Zustand, Redux, Context)
- TypeScript patterns and types
- Naming conventions

Just paste the links and I'll clone the style!"

**If local:**

"Share the path to your code:

**Examples:**
- `/Users/you/projects/my-app`
- `~/Documents/my-project`
- `./relative/path/from/workspace`

I'll read the directory structure and key files to understand:
- How you organize components
- Your coding style and conventions
- Patterns I should follow

You can share multiple paths if you want me to draw from several projects."

**If paste:**

"Paste code snippets you'd like me to use as reference:

**Great things to share:**
- A component that shows your preferred structure
- Your Tailwind config or CSS patterns
- TypeScript types or interfaces
- API client code or hooks
- Any patterns you want me to replicate

Just paste directly into the chat - I'll extract the style and patterns!"

**Processing code references:**

For **GitHub URLs:**
1. Use WebFetch to retrieve repository contents
2. Analyze package.json for dependencies and scripts
3. Read key config files (tsconfig, tailwind.config, vite.config)
4. Sample 3-5 components to understand patterns
5. Document the coding style for use during implementation

For **Local paths:**
1. Read directory structure with LS
2. Read package.json and config files
3. Sample key components and utilities
4. Extract patterns and conventions

For **Pasted code:**
1. Analyze structure, naming, and style
2. Identify patterns to replicate
3. Note any libraries or utilities used

**Create a Style Profile:**
After analyzing, create a mental style guide including:
- File naming: `kebab-case.tsx` vs `PascalCase.tsx`
- Component structure: functional, arrow functions, exports
- Import style: absolute (`@/`) vs relative
- Styling: Tailwind classes, CSS modules, styled-components
- State: hooks, stores, patterns
- TypeScript: strict mode, interface vs type

### Step 7: Existing Data

Use AskQuestion:

```json
{
  "title": "Existing Data (Optional)",
  "questions": [{
    "id": "existing_data",
    "prompt": "Do you have any existing data you'd like to build this app around?",
    "options": [
      { "id": "files", "label": "Yes, I have data files (CSV, Excel, JSON, etc.)" },
      { "id": "database", "label": "Yes, I have a database or API" },
      { "id": "examples", "label": "Yes, I can share some example data" },
      { "id": "none", "label": "No, generate sample data for me" }
    ]
  }]
}
```

**If files:**

"Please share your data files. You can:
- **Drag and drop** files directly into this chat
- **Provide file paths** - e.g., `/Users/you/Documents/data.csv`
- **Share a folder path** - e.g., `~/Downloads/project-data/`

I'll store them in `ui/src/data/` and analyze them to:
- Understand your data structure and field names
- Create appropriate TypeScript types
- Build UI components that match your data
- Generate realistic sample data that matches your schema"

**If database:**

"Tell me about your database or API:
- **Database type** - PostgreSQL, MySQL, MongoDB, etc.
- **API endpoint** - REST API URL or GraphQL endpoint
- **Sample response** - Paste an example of the data structure

I'll create API clients and types that match your data source."

**If examples:**

"Please share some example data - you can paste it directly in chat:
- A few rows from a spreadsheet
- A sample JSON object
- Field names and example values

I'll use this to understand your data structure and create matching components."

**Processing user data:**
- **Files:** Copy to `ui/src/data/` folder, parse structure, generate TypeScript interfaces
- **Database/API:** Document connection details (no secrets!), create API client stubs
- **Examples:** Parse structure, create types, generate expanded sample data

**Data folder structure:**
```
ui/src/data/
├── raw/              # Original user-provided files
├── types.ts          # TypeScript interfaces for data
├── sample-data.ts    # Generated sample data matching schema
└── README.md         # Documents data sources and structure
```

### Step 8: App Name

Ask in chat:

"**What would you like to call your app?**

Examples: 'Client Portal', 'Feedback Tracker', 'Project Dashboard'"

### Step 9: Runtime Choice

First, explain the options in chat:

"**How would you like to run your app?**

I can run your app in two ways:

**Local** (Recommended) - Runs directly on your computer using Node.js and Python. Fast iteration, standard developer workflow. *Best for most developers.*

**Docker** - Think of it as a 'container' that has everything your app needs built in. No Node.js or Python setup required. *Best if you don't want to install development tools.*"

Then use AskQuestion with a simple choice:

```json
{
  "title": "Choose how to run",
  "questions": [{
    "id": "runtime",
    "prompt": "Which option works for you?",
    "options": [
      { "id": "local", "label": "Local (Recommended)" },
      { "id": "docker", "label": "Docker (No local setup)" }
    ]
  }]
}
```

### Step 9b: Docker Setup (if Docker selected)

**Check if Docker is running:**
```bash
docker info > /dev/null 2>&1 && echo "DOCKER_RUNNING" || echo "DOCKER_NOT_RUNNING"
```

**If not running, guide them:**

```json
{
  "title": "Let's Get Docker Running",
  "questions": [{
    "id": "docker_status",
    "prompt": "Docker needs to be open for your app to run.\n\nDo you have Docker Desktop installed?",
    "options": [
      { "id": "installed", "label": "Yes, I have Docker Desktop" },
      { "id": "not_installed", "label": "No, I need to install it" }
    ]
  }]
}
```

If not installed: Provide download link and wait for them to install.

If installed: Tell them to open Docker Desktop, then ask:

```json
{
  "title": "Is Docker Running?",
  "questions": [{
    "id": "docker_open",
    "prompt": "Is Docker Desktop open and running?\n\nLook for a whale icon in your menu bar (Mac) or system tray (Windows).",
    "options": [
      { "id": "yes", "label": "Yes, Docker is running" },
      { "id": "no", "label": "I'm having trouble" }
    ]
  }]
}
```

**Once Docker confirmed running, automatically start the app:**
```bash
cd deployer-apps/citizen-dev7/src
./scripts/docker-dev.sh
```

## After Collecting Inputs (Steps 1-8)

### MANDATORY: Create Cursor Plan File (.plan.md)

**Before building anything, you MUST create a Cursor-native plan file.**

Cursor has a built-in plan format that renders with:
- A formatted header with title and description
- A **"Build this"** button that executes the plan
- Architecture diagrams (Mermaid)
- Structured implementation tasks with checkboxes

#### Step A: Create the Plan File

Write a `.plan.md` file to `~/.cursor/plans/[app_name_snake_case]_[random_8char_hex].plan.md`

The file MUST have this structure:

```markdown
---
name: Build [App Name]
overview: [One sentence describing what this app does and its main features]
todos:
  - id: setup-types
    content: Create TypeScript interfaces for [domain objects]
    status: pending
  - id: setup-data
    content: Create sample data with realistic [domain-specific] content
    status: pending
  - id: setup-store
    content: Create Zustand store with state management
    status: pending
  - id: create-navigation
    content: Create Navigation component with sidebar
    status: pending
  - id: create-dashboard
    content: Create Dashboard with [specific features]
    status: pending
  - id: create-[feature]
    content: Create [FeatureComponent] with [functionality]
    status: pending
  - id: update-app
    content: Update App.tsx with layout and routing
    status: pending
  - id: cleanup
    content: Remove unused components, update package.json/index.html
    status: pending
isProject: false
---

# Build [App Name]

## Current State

[Describe what exists and what needs to be created]

## Architecture

```mermaid
flowchart TB
    subgraph layout [App Layout]
        App[App.tsx]
        Nav[Navigation]
        Main[Main Content Area]
    end
    
    subgraph views [Views]
        Dashboard
        [Feature1]
        [Feature2]
    end
    
    subgraph data [Data Layer]
        Store[Zustand Store]
        Types[TypeScript Types]
    end
    
    App --> Nav
    App --> Main
    Main --> Dashboard
    Main --> [Feature1]
    Dashboard --> Store
```

## Implementation Details

### 1. [Component Name]
[Details about what this component does]

### 2. [Next Component]
[Details...]

## File Structure After Implementation

```
src/
  components/
    [List components]
  data/
    types.ts
    sample-data.ts
  store.ts
  App.tsx
```
```

#### Step B: Tell User About the Plan

After creating the file, tell the user:

"I've created an implementation plan that you can view in Cursor's Plans panel. 

Look for **'Build [App Name]'** - it has a **'Build this'** button that will execute the plan.

You can:
- Click **'Build this'** to start building
- Review the architecture and implementation details first
- Ask me to modify the plan if you want changes"

#### Step C: Wait for User to Confirm

The user can either:
1. Click the "Build this" button in the plan UI
2. Say "build it", "yes", "looks good" in chat

**DO NOT proceed until user confirms or clicks Build.**

#### Step D: Apply Customizations

Once confirmed, apply customizations:

1. **Set app name** in package.json, index.html, headers
2. **Use description** to name pages and generate sample data
3. **Apply visual inspiration** (colors, layout, style)
4. **Add selected features** (components, pages, routing)
5. **Adjust polish level** based on purpose

### Feature Components

| Feature | What to Add |
|---------|-------------|
| Dashboard & Charts | Chart components, Dashboard page, sample data |
| Forms & Data Entry | Form components, validation, sample form |
| Data Analytics | Data table, filters, export button |
| AI Chatbot | Chat UI (existing), placeholder responses |
| File Upload/Download | Upload component, file list |
| User Login | Login page, auth wrapper |
| Connect to External Data | API client, data hooks |

### Start the App

Ask if they want to start:

```json
{
  "title": "Your App is Ready!",
  "questions": [{
    "id": "start",
    "prompt": "Would you like to start your app now?",
    "options": [
      { "id": "yes", "label": "Yes, start it - Opens at http://localhost:3000" },
      { "id": "no", "label": "No, I want to customize more first" }
    ]
  }]
}
```

**If yes:** Run Docker or local dev commands
**If no:** Explain they can use `/launch` anytime

### Show Next Steps

Tailored to their selections:
- "Your Dashboard has sample charts. Try: 'Change the chart colors'"
- "Your form is ready. Try: 'Add a phone number field'"
- If chatbot: "Run `/add-ai` when you want to enable AI responses"

## Critical Instructions

1. **MANDATORY: CREATE .plan.md FILE** - After collecting inputs:
   - Create a Cursor plan file at `~/.cursor/plans/[app_name]_[hex].plan.md`
   - Use YAML frontmatter with `name`, `overview`, `todos`, `isProject: false`
   - Include Mermaid architecture diagram in the body
   - Wait for user to click "Build this" button or confirm in chat
   - DO NOT write any code until user confirms
2. **BE CONVERSATIONAL** - Friendly wizard, not a form
3. **WAIT FOR RESPONSES** - Don't rush
4. **HANDLE IMAGES** - If shared, analyze for design inspiration
5. **ACTUALLY BUILD** - After plan is confirmed, make real changes to the codebase
6. **OFFER TO START** - Don't leave them wondering what's next
